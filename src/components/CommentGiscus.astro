
<br />
<div id="giscus-container"></div>
<script>
    function loadGiscus(theme: string) {
        if (theme === "winter") {
          theme = "light";
        }else if (theme === "dracula") {
          theme = "dark";
        } else {
          theme = "light";
        }

        const container = document.getElementById('giscus-container')!;
        container.innerHTML = ''; // Clear existing giscus

        const script = document.createElement('script');
        script.src = 'https://giscus.app/client.js';
        script.setAttribute('data-repo', 'Kori-Sama/personal-website-astro');
        script.setAttribute('data-repo-id', 'R_kgDOMhsfzA');
        script.setAttribute('data-category', 'Announcements');
        script.setAttribute('data-category-id', 'DIC_kwDOMhsfzM4ChjLH');
        script.setAttribute('data-mapping', 'pathname');
        script.setAttribute('data-strict', '0');
        script.setAttribute('data-reactions-enabled', '1');
        script.setAttribute('data-emit-metadata', '0');
        script.setAttribute('data-input-position', 'bottom');
        script.setAttribute('data-theme', theme);
        script.setAttribute('data-lang', 'en');
        script.setAttribute('crossorigin', 'anonymous');
        script.async = true;
        
        container.appendChild(script);
    }

    function changeTheme(newTheme:string) {
        localStorage.setItem('theme', newTheme);
        loadGiscus(newTheme);
    }

    // Initial load
    const currentTheme = localStorage.getItem('theme') || 'winter';
    loadGiscus(currentTheme);

    function onCommentThemeChange() {
        const newTheme = currentTheme === "winter" ? "dracula" : "winter";
        changeTheme(newTheme);
    }

    window.onCommentThemeChange = onCommentThemeChange;

</script>